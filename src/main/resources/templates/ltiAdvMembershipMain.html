<!DOCTYPE html>
<!--suppress CheckEmptyScriptTag -->
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.thymeleaf.org "
      xml:lang="en">
<head>
    <title>LTI 3 </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}"/>
</head>
<body>
<h4>Membership: </h4>
<p>&nbsp;</p>
<div th:if="${noSessionValues}">
    <p>To view the membership you need first to access to the tool with a lti13 link. In that way, we will have a value
        in the course and the deployment. </p>
    <p>That is only the way we have secured this endpoint, because LTI Advantage allows you to access to the membership
        service without a session created. </p>
</div>
<div th:if="${results != null and !#lists.isEmpty(results)}">
    <h4>Users on the course <span th:text="${#session.getAttribute('context_id')}"/></h4>
    <table class="table table-striped">
        <caption>Lineitmes</caption>
        <thead class="thead-dark">
        <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col">userId</th>
            <th scope="col">Role</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user,rowStat : ${results}">
            <td th:text="${rowStat.count}">1</td>
            <td th:text="${user.name}"></td>
            <td th:text="${user.userId}"></td>
            <td th:text="${#strings.listJoin(user.roles,', ')}"></td>
        </tr>
        </tbody>
    </table>
</div>

<div th:if="${results != null and #lists.isEmpty(results)}">
    <p>We are not receiving users for this context</p>
</div>
<p>&nbsp;</p>


<h4>SESSION</h4>

<div>
    <ul class="list-group">
        <li class="list-group-item ">
            <label><strong>user_id</strong></label>
            <span th:text="${#session.getAttribute('user_id')}"/>
        </li>
        <li class="list-group-item ">
            <label><strong>user_role</strong></label>
            <span th:text="${#session.getAttribute('user_role')}"/>
        </li>
        <li class="list-group-item ">
            <label><strong>The Lti context id:</strong></label>
            <span th:text="${#session.getAttribute('context_id')}"/>
        </li>
        <li class="list-group-item ">
            <label><strong>Our internal deployment key (our id in the database):</strong></label>
            <span th:text="${#session.getAttribute('tool_deployment_id')}"/>
        </li>
    </ul>
</div>

</body>
</html>
